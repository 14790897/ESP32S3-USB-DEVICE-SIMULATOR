# ESP32-S3 USB MSC å¿«é€Ÿå…¥é—¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®åˆ°æœ¬åœ°
# ç¡®ä¿å·²å®‰è£… PlatformIO
pio --version
```

### 2. é€‰æ‹©å®ç°ç‰ˆæœ¬

#### æ–¹æ³•A: ä½¿ç”¨è„šæœ¬åˆ‡æ¢ (æ¨è)
```bash
# Linux/Mac
./switch_version.sh native    # ESP32åŸç”Ÿç‰ˆæœ¬ (æ¨èæ–°æ‰‹)
./switch_version.sh tinyusb   # TinyUSBåŸºç¡€ç‰ˆæœ¬
./switch_version.sh advanced  # TinyUSBé«˜çº§ç‰ˆæœ¬

# Windows
switch_version.bat native     # ESP32åŸç”Ÿç‰ˆæœ¬ (æ¨èæ–°æ‰‹)
switch_version.bat tinyusb    # TinyUSBåŸºç¡€ç‰ˆæœ¬
switch_version.bat advanced   # TinyUSBé«˜çº§ç‰ˆæœ¬
```

#### æ–¹æ³•B: æ‰‹åŠ¨åˆ‡æ¢
1. å¤‡ä»½å½“å‰ `src/main.cpp`
2. ä»ç›¸åº”ç›®å½•å¤åˆ¶æ–‡ä»¶åˆ° `src/main.cpp`
3. æ›´æ–° `platformio.ini` é…ç½®

### 3. ç¼–è¯‘å’Œä¸Šä¼ 
```bash
# ç¼–è¯‘é¡¹ç›®
pio run

# ä¸Šä¼ åˆ°ESP32-S3
pio run --target upload

# æŸ¥çœ‹ä¸²å£è¾“å‡º
pio device monitor
```

### 4. æµ‹è¯•åŠŸèƒ½
1. **è¿æ¥è®¾å¤‡**: ä½¿ç”¨USBæ•°æ®çº¿è¿æ¥ESP32-S3åˆ°ç”µè„‘
2. **æŸ¥çœ‹é©±åŠ¨å™¨**: åœ¨ç”µè„‘ä¸Šåº”è¯¥ä¼šå‡ºç°æ–°çš„USBé©±åŠ¨å™¨
3. **æµ‹è¯•è¯»å†™**: å°è¯•åœ¨é©±åŠ¨å™¨ä¸­åˆ›å»º/åˆ é™¤æ–‡ä»¶

## ğŸ“‹ ç‰ˆæœ¬å¯¹æ¯”

| ç‰ˆæœ¬ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **ESP32åŸç”Ÿ** | ç®€å•ç¨³å®šã€ä»£ç é‡å°‘ | åŠŸèƒ½åŸºç¡€ | å­¦ä¹ æµ‹è¯•ã€ç®€å•åº”ç”¨ |
| **TinyUSBåŸºç¡€** | è·¨å¹³å°ã€åŠŸèƒ½ä¸°å¯Œ | å¤æ‚åº¦é«˜ | ä¸“ä¸šå¼€å‘ |
| **TinyUSBé«˜çº§** | å®Œæ•´æ–‡ä»¶ç³»ç»Ÿ | å†…å­˜å ç”¨å¤§ | äº§å“çº§åº”ç”¨ |

## ğŸ› ï¸ å¸¸è§é—®é¢˜

### Q: è®¾å¤‡æ— æ³•è¯†åˆ«ï¼Ÿ
**A**: æ£€æŸ¥USBè¿æ¥çº¿æ˜¯å¦æ”¯æŒæ•°æ®ä¼ è¾“ï¼Œç¡®è®¤GPIO19/20è¿æ¥æ­£ç¡®

### Q: ç¼–è¯‘å¤±è´¥ï¼Ÿ
**A**: 
1. ç¡®è®¤PlatformIOç‰ˆæœ¬ >= 6.0
2. æ¸…ç†ç¼“å­˜: `pio run --target clean`
3. æ£€æŸ¥ä¾èµ–åº“ç‰ˆæœ¬

### Q: æ–‡ä»¶æ— æ³•å†™å…¥ï¼Ÿ
**A**: 
1. æ£€æŸ¥å›è°ƒå‡½æ•°å®ç°
2. ç¡®è®¤RAMç£ç›˜å¤§å°è®¾ç½®
3. æŸ¥çœ‹ä¸²å£è°ƒè¯•ä¿¡æ¯

### Q: é¢‘ç¹é‡å¯ï¼Ÿ
**A**: 
1. åˆ‡æ¢åˆ°ESP32åŸç”Ÿç‰ˆæœ¬
2. æ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ
3. é™ä½æ—¶é’Ÿé¢‘ç‡æµ‹è¯•

## ğŸ“ é¡¹ç›®ç»“æ„
```
S3-card/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main.cpp              # å½“å‰æ´»åŠ¨ç‰ˆæœ¬
â”œâ”€â”€ tinyusb_version/
â”‚   â”œâ”€â”€ main.cpp             # TinyUSBåŸºç¡€ç‰ˆæœ¬
â”‚   â”œâ”€â”€ tinyusb_advanced.cpp # TinyUSBé«˜çº§ç‰ˆæœ¬
â”‚   â””â”€â”€ platformio.ini       # TinyUSBé…ç½®
â”œâ”€â”€ platformio.ini           # å½“å‰é¡¹ç›®é…ç½®
â”œâ”€â”€ switch_version.sh        # ç‰ˆæœ¬åˆ‡æ¢è„šæœ¬(Linux/Mac)
â”œâ”€â”€ switch_version.bat       # ç‰ˆæœ¬åˆ‡æ¢è„šæœ¬(Windows)
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ é«˜çº§é…ç½®

### ä¿®æ”¹ç£ç›˜å¤§å°
```cpp
// ESP32åŸç”Ÿç‰ˆæœ¬
#define DISK_SECTOR_COUNT 64  // 32KB = 64 * 512å­—èŠ‚

// TinyUSBç‰ˆæœ¬
static uint8_t msc_disk[8192];  // 8KB RAMç£ç›˜
```

### è‡ªå®šä¹‰USBæè¿°ç¬¦
```cpp
// åœ¨setup()ä¸­ä¿®æ”¹
USB.productName("æˆ‘çš„USBè®¾å¤‡");
USB.manufacturerName("æˆ‘çš„å…¬å¸");
```

### æ·»åŠ æ–‡ä»¶å†…å®¹
```cpp
// å‚è€ƒ tinyusb_advanced.cpp ä¸­çš„æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºå‡½æ•°
void create_fat12_filesystem() {
    // åœ¨è¿™é‡Œæ·»åŠ æ‚¨çš„æ–‡ä»¶...
}
```

## ğŸ“š æ›´å¤šèµ„æº

- [ESP32-S3æŠ€æœ¯å‚è€ƒæ‰‹å†Œ](https://docs.espressif.com/projects/esp-idf/en/latest/esp32s3/)
- [TinyUSBå®˜æ–¹æ–‡æ¡£](https://docs.tinyusb.org/)
- [PlatformIO ESP32å¼€å‘æŒ‡å—](https://docs.platformio.org/en/latest/platforms/espressif32.html)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼